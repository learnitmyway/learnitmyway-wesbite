{{ define "canonical" }}
  {{ if .Params.canonical }}
    <link rel="canonical" href="{{ .Permalink }}">
  {{ end }}
{{ end }}

{{ define "title" }}{{ .Title }} | {{ .Site.Title }}{{ end }}
{{ define "description" }}{{ .Params.excerpt }}{{ end }}
{{ define "header" }}
<header></header>
{{ partial "site-navigation.html" . }}
{{ end }}

{{ define "main" }}
<div class="page">
  <article class="article">
    <time class="article__date" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
      {{ .Date.Format "January 2, 2006" }}
    </time>
    <h1 class="article__title">{{ .Title }}</h1>
    {{ if and .Params.toc .TableOfContents }}
    <div class="article__toc nested-links">
      {{ .TableOfContents }}
    </div>
    {{ end }}
    
    {{ if .Params.isPremium }}
      <!-- Premium article: Show preview + paywall + placeholder for server-fetched content -->
      <section class="article__content--preview nested-links">
        {{ .Summary }}
      </section>
      
      {{ partial "server-side-paywall.html" . }}
      
      <!-- Placeholder for premium content (fetched from API) -->
      <div id="premium-content" class="article__content nested-links"></div>
    {{ else }}
      <!-- Regular article: Show full content -->
      <section class="article__content nested-links">
        {{ .Content }}
      </section>
    {{ end }}
    
    {{ partial "article-footer.html" . }}
  </article>
  <div class="article-extra">
    {{ partial "extra-content.html" . }}
  </div>
</div>
{{ end }}